# 第八章：技术团队如何设计安全结构

技术团队的人，其实是互联网公司里面最脆弱的一环。

因为技术代码或数据库要是蒙受灾难，将会给公司带来重创。

然而，成员会离职，团队成员会变心，新成员会犯低级错误，技术团队掌握的信息会被窃取，。

如何设计一个相对安全的技术团队组织架构，其实是捍卫公司资产最重要的工作。

## 代码与密码分离

我们在前面几章提过。团队里面犯的低级错误，就是将数据库与第三方的密码，直接 hard code 写在代码库里面，还进了「版本控制」。

所以首先要做的是：

1. 检查代码里面有没有含任何密码，将代码与密码分离，并且将相关 history 清掉。
2. 不同环境的代码使用不同环境的密码。


## 密码使用集中工具管理

一个互联网团队，一定会使用非常多第三方服务的密码。

这些服务的原始密码可能存在团队成员里面的微信，对话记录等等等。

离职难以清理以及更换。

比较好的方式

1. 是强制技术团队回收，统一使用 1Password 企业版管理。根据不同存取的权限，开放不同服务的密码。有团队成员离职直接 reset 一遍。
2. 严令禁止团队成员使用任何形式的 im 传递，以及写在公司 wiki 之上。

## 存取公司使用的服务一律启用团队成员 2FA

我较常听到的案例，往往不是企业本身的架构被打进去。而是企业成员使用的第三方服务，因为没有保护，所以被入侵。

包括 Slack、Github、Trello、Jenkins、Gmail 等等。

所以如果你有这些协作工具，记得一开始预设就要开启全员的 2FA。

## 自动化部署

虽然 2019 年了，但是很多团队还是属于手工部署（FTP / git pull ）。这其实是很危险的事。

因为上传或透过人直接连到机器操作是很危险的事。

现在都有很多自动化部署工具，只要一个指令就能自动部署。

另外关于自动部署这件事，要做到：

* 代码能够自动化部署，重起服务
* 作业系统配置与部署也可以自动化

而且甚至部署这件事，不是程序员可以直接部署，而是架构师级别以上才能部署，或者是有专属的 Release Manager 负责部署。

部署本身有自动部署系统，能够纪录是谁部署，还可以做权限风控系统。

## 企业资产保管

交易所类似公司钱包这一类服务。要动用资产必须多重签名与管控。

也可以使用企业钱包签核。在冷热钱包当中加一道温钱包，用风控系统管理。

并且关于金额的变动，必须内部帐要对的帐。所以款项放行每一笔必须要有 Log


## 离职一键注销

企业最怕的是成员离职将公司重要机密带走。离职当日，一律直接扣留笔电，失效所有帐号与存取权限。

另外入职前必须请律师拟好就业合同，保密合同，离职合同。请他们签署。利用法律先行约束行为。

离职员工多半是 70% 以上多半是不满意现状而离开的。你不能假设这些同事不作恶。

所以得先小人后君子。
